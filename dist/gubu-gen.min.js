!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).GubuGen=t()}}((function(){var t={exports:{}};(function(e){(function(){!function(n){"object"==typeof t.exports?t.exports=n():("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:this).Carn=n()}((function(){var t={};Object.defineProperty(t,"__esModule",{value:!0}),t.Carn=void 0,t.Carn=class{constructor(){this.newline="\n",this.indent="  ",this.separator=",",this.dI=0,this.id=1e6*Math.random()|0,this.s=[]}start(){this.s=[]}add(t){"string"==typeof t&&this.s.push(t)}sep(){this.s.push(new n(this.separator))}depth(t){"number"==typeof t&&(this.dI+=t,this.s.push(new e(this.dI,this.indent)))}src(){let t="";for(let s=0;s<this.s.length;s++){let i=s;this.s[i]instanceof e?(t=this.s[i].toString(),this.s[i]=""):(this.s[i+1]instanceof n&&(this.s[i+2]instanceof e||(this.s[i]+=this.s[i+1].toString()),this.s[i+1]="",s++),this.s[i]=t+this.s[i]+this.newline)}return this.s.join("")+this.newline}inject(t,e,n){let s=this.src();s=s.startsWith("\n")?s:"\n"+s,s=s.endsWith("\n")?s:s+"\n";let i=n[0],o=n[1];const r=new RegExp(i+"START:"+e+o+".*?"+i+"END:"+e+o,"s");return t.replace(r,i+"START:"+e+o+s+i+"END:"+e+o)}};class e{constructor(t,e){this.depth=t,this.indent=e}toString(){return this.indent.repeat(this.depth)}}class n{constructor(t){this.separator=t}toString(){return this.separator}}return t}))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),t=t.exports;var e={},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.MarkerMap=e.GeneratorMap=e.GubuGen=void 0;const s=n({}),i={md:["\x3c!--","--\x3e"]};e.MarkerMap=i;const o={"options~md":function(t,e){var n;e.start(),e.add("## Options");let s=[];t(void 0,{err:!1,log:(t,e)=>{if("kv"===t){let t=e.path.slice(1,e.dI+1),n=t.join("."),i=e.node,o=e.key;s.push({path:n,parts:t,node:i,key:o})}}}),s=s.sort((t,e)=>t.path<e.path?-1:t.path>e.path?1:0);let i=1;for(let o of s){let{path:t,parts:s,node:r,key:a}=o,d=r.t,f=r.r,h=r.v,l=(null===(n=r.m)||void 0===n?void 0:n.short)||a,u=s[s.length-1];for(;i<s.length;)e.add(`* _${s[i-1]}_`),e.depth(1),i++;for(;s.length<i;)e.depth(-1),i--;e.add(`* _${u}_: \`${d}\` ${f?"(required)":"(default: "+h+")"} - ${l}`)}}};return e.GeneratorMap=o,e.GubuGen=class{constructor(){}generate(e){let n=function(t,e){let n=t.generator,s=t.format,i=o[n+"~"+s];if(null===i){let e=`Cannot find generator ${t.generator} for format ${t.format}`;throw new Error(e)}return i}(e);const r=new t.Carn;n(e.shape,r);let a=(d=e.target,s.default.readFileSync(d).toString());var d;let f=r.inject(a,e.generator,i[e.format]);return function(t,e){s.default.writeFileSync(t,e)}(e.target,f),r}},e}));