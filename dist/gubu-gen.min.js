!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).GubuGen=t()}}((function(){var t={exports:{}};(function(e){(function(){!function(n){"object"==typeof t.exports?t.exports=n():("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:this).Carn=n()}((function(){var t={};Object.defineProperty(t,"__esModule",{value:!0}),t.Carn=void 0,t.Carn=class{constructor(){this.newline="\n",this.indent="  ",this.separator=",",this.dI=0,this.id=1e6*Math.random()|0,this.s=[]}start(){this.s=[]}add(t){"string"==typeof t&&this.s.push(t)}sep(){this.s.push(new n(this.separator))}depth(t){"number"==typeof t&&(this.dI+=t,this.s.push(new e(this.dI,this.indent)))}src(){let t="";for(let o=0;o<this.s.length;o++){let s=o;this.s[s]instanceof e?(t=this.s[s].toString(),this.s[s]=""):(this.s[s+1]instanceof n&&(this.s[s+2]instanceof e||(this.s[s]+=this.s[s+1].toString()),this.s[s+1]="",o++),this.s[s]=t+this.s[s]+this.newline)}return this.s.join("")+this.newline}inject(t,e,n){let o=this.src();o=o.startsWith("\n")?o:"\n"+o,o=o.endsWith("\n")?o:o+"\n";let s=n[0],i=n[1];const r=new RegExp(s+"START:"+e+i+".*?"+s+"END:"+e+i,"s");return t.replace(r,s+"START:"+e+i+o+s+"END:"+e+i)}};class e{constructor(t,e){this.depth=t,this.indent=e}toString(){return this.indent.repeat(this.depth)}}class n{constructor(t){this.separator=t}toString(){return this.separator}}return t}))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),t=t.exports;var e={},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.MarkerMap=e.GeneratorMap=e.GubuGen=void 0;const o=n({}),s={md:["\x3c!--","--\x3e"]};e.MarkerMap=s;const i={"options~md":function(t,e){var n;e.start(),e.add("## Options"),console.log("GS",t);let o=[];t(void 0,{err:!1,log:(t,e)=>{if(console.log("POINT",t),"kv"===t){let t=e.path.slice(1,e.dI+1),n=t.join("."),s=e.node,i=e.key;o.push({path:n,parts:t,node:s,key:i})}}}),o=o.sort((t,e)=>t.path<e.path?-1:t.path>e.path?1:0),console.log("OPTS",o);let s=1;for(let i of o){let{path:t,parts:o,node:r,key:a}=i,d=r.t,l=r.r,f=r.v,h=(null===(n=r.m)||void 0===n?void 0:n.short)||a,u=o[o.length-1];for(;s<o.length;)e.add(`* _${o[s-1]}_`),e.depth(1),s++;for(;o.length<s;)e.depth(-1),s--;e.add(`* _${u}_: \`${d}\` ${l?"(required)":"(default: "+f+")"} - ${h}`)}}};return e.GeneratorMap=i,e.GubuGen=class{constructor(){}generate(e){console.log("GUBUGEN:",e);let n=function(t,e){let n=t.generator,o=t.format,s=i[n+"~"+o];if(null===s){let e=`Cannot find generator ${t.generator} for format ${t.format}`;throw new Error(e)}return s}(e);const r=new t.Carn;n(e.shape,r);let a=(d=e.target,o.default.readFileSync(d).toString());var d;let l=r.inject(a,e.generator,s[e.format]);return function(t,e){o.default.writeFileSync(t,e)}(e.target,l),r}},e}));